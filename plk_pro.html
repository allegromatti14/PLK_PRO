<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>MatiPLK – PLK Predictor</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{background:#0b0b0b;color:#fff;font-family:Arial;padding:15px}
h2,h3{text-align:center}
select,input,button{width:100%;padding:12px;margin:8px 0;font-size:16px}
button{background:#ff9800;border:none;font-weight:bold}
.box{background:#1a1a1a;padding:12px;border-radius:10px;margin-top:12px}
#status{text-align:center;margin:10px;font-weight:bold}
.ok{color:#6CFF6C}.bad{color:#ff4444}
</style>
</head>
<body>
<h2>MatiPLK – PLK Predictor</h2>
<div id="status">Ładowanie…</div>

<div class="box">
<label>Drużyna A (gospodarz)</label>
<select id="teamA"></select>

<label>Mecz gospodarza</label>
<select id="matchSelect"><option>— wybierz mecz —</option></select>

<label>Drużyna B</label>
<select id="teamB"></select>

<label>Data meczu</label>
<input id="matchDate" type="datetime-local" readonly>

<button onclick="predict()">ANALIZUJ</button>
</div>

<div class="box" id="result"></div>

<script>
function norm(s){return String(s).trim().replace(/\s+/g,' ')}

let teams={},matches=[];

async function load(){
  teams = await (await fetch('teams.json')).json();
  matches = await (await fetch('matches.json')).json();
  document.getElementById('status').textContent='ONLINE: działa';
  init();
}

function init(){
  const a=document.getElementById('teamA');
  const b=document.getElementById('teamB');
  Object.keys(teams).forEach(t=>{
    a.innerHTML+=`<option>${t}</option>`;
    b.innerHTML+=`<option>${t}</option>`;
  });
  a.onchange=updateMatches;
  document.getElementById('matchSelect').onchange=applyMatch;
  updateMatches();
}

function updateMatches(){
  const host=norm(teamA.value);
  const ms=document.getElementById('matchSelect');
  ms.innerHTML='<option>— wybierz mecz —</option>';
  matches.filter(m=>norm(m.home)===host).forEach(m=>{
    const d=new Date(m.start);
    ms.innerHTML+=`<option value="${m.id}">${d.toLocaleString('pl-PL')} vs ${m.away}</option>`;
  });
}

function applyMatch(){
  const id=matchSelect.value;
  const m=matches.find(x=>x.id===id);
  if(!m)return;
  teamB.value=m.away;
  const d=new Date(m.start);
  matchDate.value=d.toISOString().slice(0,16);
}

function score(t,home){
  const x=teams[t];
  return x.rating+(home?6:0)+Math.random()*5;
}

function predict(){
  const a=teamA.value,b=teamB.value;
  const sa=score(a,true),sb=score(b,false);
  const win=sa>sb?a:b;
  result.innerHTML=`<h3>Typ: ${win}</h3>`;
}

load();
</script>
</body>
</html>
